{"block":{"30be3dcd-5100-81e3-85bb-e4a7beac5052":{"type":"reader","value":{"id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","content":["7aca6954-6493-4f9c-adea-5cd3196d35f3","3535078f-e612-4088-8eeb-56f0dba4f715","0756beee-c025-40e1-b0d6-aff2c98e9b8b","c3dca6b2-6953-4efd-bc75-334b52d2bdf7","532a3c49-14a9-4090-b6c5-f77f54e6ee6a","b55cacbd-60b6-4adb-828a-bc1c0821703a","22de8748-e3a6-4b58-aad9-a9394bb0f517","1e6da941-6f4f-4f85-8c81-e1eaca539d8f","dcb435b5-744b-47b7-91d6-4a8132151e5c","8c5001c9-5492-4462-89d5-31653d1159d6","2a44120a-d56b-4123-828c-cf37128416cf","21af4a1d-d8b3-43a7-9f39-cf8f47e827a8","041dbb97-bbb7-4463-bc2a-108c12bc5cb3","76f3de62-430e-453e-98f1-1106d781bf08","1b9431c8-cdd9-4ae8-a128-e0e15fc86aeb","b0c36082-b8f9-4abf-ac2e-4dda0c026028","cf01ad2b-b6b7-45e4-99c4-d32953ba36a3","728db129-e5ed-4a15-bd39-ae48ddc1ef09","73192fac-af48-49f8-9d98-e796d69c00f1","faf3bde9-d01b-4dae-9047-2d850b80aa6e","467b1ede-98fb-4e89-8e48-3dea57934ac1","24061870-884d-4b5c-a617-44c00ebd8d2d","fd6f42a2-a19b-40dc-8bfe-053191e49345","5027d112-40db-457b-afa4-8dddab2ba186","0e08501a-a8e3-4acf-aeeb-c76177ba4fbf","67334072-bf1b-4099-ad50-3d17dc435988","ec18262d-f0df-4e61-97c7-103cf8ad653e","10c86ccf-17d2-4ec7-a962-246fdec30f68"],"properties":{"title":[["Days 2-4: The Monorepo Migration Sprint (111 Commits in 3 Days)"]]},"format":{},"type":"page","created_time":1771421700000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"dca90ad9-3257-474e-b521-628c56118169","parent_table":"table"}},"dca90ad9-3257-474e-b521-628c56118169":{"type":"reader","value":{"id":"dca90ad9-3257-474e-b521-628c56118169","properties":{},"format":{},"type":"child_database","created_time":1711415040000,"last_edited_time":1771510920000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true}},"7aca6954-6493-4f9c-adea-5cd3196d35f3":{"type":"reader","value":{"id":"7aca6954-6493-4f9c-adea-5cd3196d35f3","properties":{"title":[["Three days. 111 commits. And I'm pretty sure half of them have commit messages that just say \"fix css.\""]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"3535078f-e612-4088-8eeb-56f0dba4f715":{"type":"reader","value":{"id":"3535078f-e612-4088-8eeb-56f0dba4f715","properties":{"title":[["Day 2: CSS Restoration Hell — 38 Commits"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"0756beee-c025-40e1-b0d6-aff2c98e9b8b":{"type":"reader","value":{"id":"0756beee-c025-40e1-b0d6-aff2c98e9b8b","properties":{"title":[["When I unified the Tailwind config into "],["packages/config",[["c"]]],[", every app that relied on custom design tokens broke. Not in an obvious \"red error screen\" way. In a subtle \"the background is slightly wrong and why is that button 2px smaller\" way."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"c3dca6b2-6953-4efd-bc75-334b52d2bdf7":{"type":"reader","value":{"id":"c3dca6b2-6953-4efd-bc75-334b52d2bdf7","properties":{"title":[["The problem: each app had evolved its own CSS variable namespace. BaZi used "],["--bz-*",[["c"]]],[" tokens. Tarot used "],["--tarot-*",[["c"]]],[". Astrology used "],["--zx-*",[["c"]]],[". Unifying the Tailwind config meant these all had to coexist without collision, while still allowing each app its own visual identity."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"532a3c49-14a9-4090-b6c5-f77f54e6ee6a":{"type":"reader","value":{"id":"532a3c49-14a9-4090-b6c5-f77f54e6ee6a","properties":{"title":[["38 commits. Each one fixing some CSS gap I'd missed. But by the end I'd also extracted 4 new shared packages: PDF generation, chat history, shared chat UI, and common React hooks."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"b55cacbd-60b6-4adb-828a-bc1c0821703a":{"type":"reader","value":{"id":"b55cacbd-60b6-4adb-828a-bc1c0821703a","properties":{"title":[["The package extraction was the real win. Three apps each had their own "],["ChatPanel",[["c"]]],[" component with slightly different implementations. Three apps each had PDF export code with the same html2canvas workflow. Extracting these into "],["packages/ui",[["c"]]],[" and "],["packages/pdf",[["c"]]],[" meant a single fix would propagate everywhere."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"22de8748-e3a6-4b58-aad9-a9394bb0f517":{"type":"reader","value":{"id":"22de8748-e3a6-4b58-aad9-a9394bb0f517","properties":{"title":[["Day 3: App #6 and WeChat Detection — 17 Commits"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"1e6da941-6f4f-4f85-8c81-e1eaca539d8f":{"type":"reader","value":{"id":"1e6da941-6f4f-4f85-8c81-e1eaca539d8f","properties":{"title":[["Added MBTI personality test as the sixth app. Easier to integrate because I built it knowing it would go into the monorepo — it used the shared packages from day one."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"dcb435b5-744b-47b7-91d6-4a8132151e5c":{"type":"reader","value":{"id":"dcb435b5-744b-47b7-91d6-4a8132151e5c","properties":{"title":[["The more interesting challenge was WeChat browser detection. A massive percentage of Chinese internet traffic goes through WeChat's built-in browser, which has quirks: limited "],["getUserMedia",[["c"]]],[" support, different OAuth flow requirements, restricted "],["window.open",[["c"]]],[" behavior. The user agent sniffing needed to check for "],["MicroMessenger",[["c"]]],[" across Android, iOS, and desktop variants, plus the WeChat Work variant ("],["wxwork",[["c"]]],[")."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"8c5001c9-5492-4462-89d5-31653d1159d6":{"type":"reader","value":{"id":"8c5001c9-5492-4462-89d5-31653d1159d6","properties":{"title":[["Later (PR #41), this detection got hardened further when real devices exposed false negatives — some WeChat versions embed a different UA string than documented."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"2a44120a-d56b-4123-828c-cf37128416cf":{"type":"reader","value":{"id":"2a44120a-d56b-4123-828c-cf37128416cf","properties":{"title":[["Day 4: The Big Day — 56 Commits"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"21af4a1d-d8b3-43a7-9f39-cf8f47e827a8":{"type":"reader","value":{"id":"21af4a1d-d8b3-43a7-9f39-cf8f47e827a8","properties":{"title":[["The Unified API Package"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"041dbb97-bbb7-4463-bc2a-108c12bc5cb3":{"type":"reader","value":{"id":"041dbb97-bbb7-4463-bc2a-108c12bc5cb3","properties":{"title":[["The biggest architectural win of the entire project. "],["packages/api",[["c"]]],[" standardized how all apps talk to AI models."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"76f3de62-430e-453e-98f1-1106d781bf08":{"type":"reader","value":{"id":"76f3de62-430e-453e-98f1-1106d781bf08","properties":{"title":[["Before: each app had its own streaming route with ~80 lines of boilerplate for "],["ReadableStream",[["c"]]],[" setup, SSE event formatting, error handling, and credit deduction. Duplicated 15+ times."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"1b9431c8-cdd9-4ae8-a128-e0e15fc86aeb":{"type":"reader","value":{"id":"1b9431c8-cdd9-4ae8-a128-e0e15fc86aeb","properties":{"title":[["After: "],["createAIStreamResponse()",[["c"]]],[" — a single helper that takes a config object with lifecycle hooks:"]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"b0c36082-b8f9-4abf-ac2e-4dda0c026028":{"type":"reader","value":{"id":"b0c36082-b8f9-4abf-ac2e-4dda0c026028","properties":{"title":[["initEvents",[["c"]]],[" — emit initial data before AI streaming starts"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"cf01ad2b-b6b7-45e4-99c4-d32953ba36a3":{"type":"reader","value":{"id":"cf01ad2b-b6b7-45e4-99c4-d32953ba36a3","properties":{"title":[["onComplete",[["c"]]],[" — save results, log costs"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"728db129-e5ed-4a15-bd39-ae48ddc1ef09":{"type":"reader","value":{"id":"728db129-e5ed-4a15-bd39-ae48ddc1ef09","properties":{"title":[["onError",[["c"]]],[" — handle failures gracefully"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"73192fac-af48-49f8-9d98-e796d69c00f1":{"type":"reader","value":{"id":"73192fac-af48-49f8-9d98-e796d69c00f1","properties":{"title":[["refundCreditsOnError",[["c"]]],[" — automatically refund if the stream dies"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"faf3bde9-d01b-4dae-9047-2d850b80aa6e":{"type":"reader","value":{"id":"faf3bde9-d01b-4dae-9047-2d850b80aa6e","properties":{"title":[["52 API routes migrated into this pattern. Claude Code did the migration by looking at one example and applying it to the rest. An hour of wall-clock time vs. what would have been a full day manually."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"467b1ede-98fb-4e89-8e48-3dea57934ac1":{"type":"reader","value":{"id":"467b1ede-98fb-4e89-8e48-3dea57934ac1","properties":{"title":[["The Content Filter v1"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"24061870-884d-4b5c-a617-44c00ebd8d2d":{"type":"reader","value":{"id":"24061870-884d-4b5c-a617-44c00ebd8d2d","properties":{"title":[["Also built on Day 4: a DFA-based sensitive word filter. This is critical for the China market. Metaphysics content naturally includes terms that trigger naive keyword filters — 算命 (fortune-telling), 破财 (wealth loss), 桃花劫 (romantic disaster). A standard profanity filter would block half our legitimate content."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"fd6f42a2-a19b-40dc-8bfe-053191e49345":{"type":"reader","value":{"id":"fd6f42a2-a19b-40dc-8bfe-053191e49345","properties":{"title":[["The DFA (Deterministic Finite Automaton) approach builds a trie from the word list and streams through text character by character. This version blocked entire messages containing sensitive words — later iterations would get more sophisticated."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"5027d112-40db-457b-afa4-8dddab2ba186":{"type":"reader","value":{"id":"5027d112-40db-457b-afa4-8dddab2ba186","properties":{"title":[["GDPR and Legal"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"0e08501a-a8e3-4acf-aeeb-c76177ba4fbf":{"type":"reader","value":{"id":"0e08501a-a8e3-4acf-aeeb-c76177ba4fbf","properties":{"title":[["Knocked out bilingual terms of service and privacy policy. Not glamorous, but necessary. These would later be completely rewritten (PR #83) with separate Chinese and English versions and China AI regulatory compliance clauses."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"67334072-bf1b-4099-ad50-3d17dc435988":{"type":"reader","value":{"id":"67334072-bf1b-4099-ad50-3d17dc435988","properties":{"title":[["The Moment"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"ec18262d-f0df-4e61-97c7-103cf8ad653e":{"type":"reader","value":{"id":"ec18262d-f0df-4e61-97c7-103cf8ad653e","properties":{"title":[["Around 11 PM I started all 6 apps locally, logged in with one account, and watched credits sync across tabs. One login. One credit balance. Six products. It actually worked."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}},"10c86ccf-17d2-4ec7-a962-246fdec30f68":{"type":"reader","value":{"id":"10c86ccf-17d2-4ec7-a962-246fdec30f68","properties":{"title":[["Three days ago I had 5 separate apps. Now I had one platform."]]},"format":{"block_color":"default"},"type":"text","created_time":1771476840000,"last_edited_time":1771476840000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true,"parent_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent_table":"block"}}},"collection":{},"collection_view":{},"collection_query":{},"signed_urls":{},"notion_user":{},"raw":{"page":{"object":"page","id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","created_time":"2026-02-18T13:35:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"dca90ad9-3257-474e-b521-628c56118169"},"archived":false,"in_trash":false,"is_locked":false,"properties":{"Series":{"id":"%3EteD","type":"select","select":{"id":"98b03ccf-c584-4fdc-bf9c-87ccb58b872a","name":"Building PanPanMao","color":"blue"}},"Part":{"id":"%3FGyQ","type":"number","number":2},"date":{"id":"NX%5CQ","type":"date","date":{"start":"2026-01-24","end":null,"time_zone":null}},"type":{"id":"%60gQ~","type":"select","select":{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","name":"Post","color":"purple"}},"slug":{"id":"d%5Dhq","type":"rich_text","rich_text":[{"type":"text","text":{"content":"panpanmao-diary-02-migration-sprint","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"panpanmao-diary-02-migration-sprint","href":null}]},"tags":{"id":"sD%5Em","type":"multi_select","multi_select":[{"id":"14e583db-d1a1-416a-92c8-61b25c8a9500","name":"AI","color":"orange"},{"id":"94107512-fb67-4f90-9644-26758c03fc71","name":"Software Development","color":"purple"}]},"URL":{"id":"w%3AG%3A","type":"url","url":null},"summary":{"id":"wz%7CS","type":"rich_text","rich_text":[{"type":"text","text":{"content":"PanPanMao build diary Days 2-4: CSS restoration hell, extracting shared packages, adding MBTI app, WeChat browser detection, and the unified API layer with 52 migrated routes.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PanPanMao build diary Days 2-4: CSS restoration hell, extracting shared packages, adding MBTI app, WeChat browser detection, and the unified API layer with 52 migrated routes.","href":null}]},"title":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"Days 2-4: The Monorepo Migration Sprint (111 Commits in 3 Days)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Days 2-4: The Monorepo Migration Sprint (111 Commits in 3 Days)","href":null}]},"status":{"id":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee","type":"select","select":{"id":"7abc61d4-b405-480d-b699-12588755fa65","name":"Published","color":"red"}}},"url":"https://www.notion.so/Days-2-4-The-Monorepo-Migration-Sprint-111-Commits-in-3-Days-30be3dcd510081e385bbe4a7beac5052","public_url":"https://xingfanxia.notion.site/Days-2-4-The-Monorepo-Migration-Sprint-111-Commits-in-3-Days-30be3dcd510081e385bbe4a7beac5052","request_id":"397d975d-4db7-4732-b4b4-47dab812e0d8"},"block":{"object":"block","id":"30be3dcd-5100-81e3-85bb-e4a7beac5052","parent":{"type":"database_id","database_id":"dca90ad9-3257-474e-b521-628c56118169"},"created_time":"2026-02-18T13:35:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":true,"archived":false,"in_trash":false,"type":"child_page","child_page":{"title":"Days 2-4: The Monorepo Migration Sprint (111 Commits in 3 Days)"},"request_id":"0363b88f-6f3f-4c19-bdf7-c775bbbe8e87"},"children":[{"object":"block","id":"7aca6954-6493-4f9c-adea-5cd3196d35f3","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Three days. 111 commits. And I'm pretty sure half of them have commit messages that just say \"fix css.\"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Three days. 111 commits. And I'm pretty sure half of them have commit messages that just say \"fix css.\"","href":null}],"color":"default"}},{"object":"block","id":"3535078f-e612-4088-8eeb-56f0dba4f715","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Day 2: CSS Restoration Hell — 38 Commits","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Day 2: CSS Restoration Hell — 38 Commits","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0756beee-c025-40e1-b0d6-aff2c98e9b8b","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"When I unified the Tailwind config into ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"When I unified the Tailwind config into ","href":null},{"type":"text","text":{"content":"packages/config","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/config","href":null},{"type":"text","text":{"content":", every app that relied on custom design tokens broke. Not in an obvious \"red error screen\" way. In a subtle \"the background is slightly wrong and why is that button 2px smaller\" way.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":", every app that relied on custom design tokens broke. Not in an obvious \"red error screen\" way. In a subtle \"the background is slightly wrong and why is that button 2px smaller\" way.","href":null}],"color":"default"}},{"object":"block","id":"c3dca6b2-6953-4efd-bc75-334b52d2bdf7","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"The problem: each app had evolved its own CSS variable namespace. BaZi used ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The problem: each app had evolved its own CSS variable namespace. BaZi used ","href":null},{"type":"text","text":{"content":"--bz-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--bz-*","href":null},{"type":"text","text":{"content":" tokens. Tarot used ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" tokens. Tarot used ","href":null},{"type":"text","text":{"content":"--tarot-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--tarot-*","href":null},{"type":"text","text":{"content":". Astrology used ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":". Astrology used ","href":null},{"type":"text","text":{"content":"--zx-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--zx-*","href":null},{"type":"text","text":{"content":". Unifying the Tailwind config meant these all had to coexist without collision, while still allowing each app its own visual identity.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":". Unifying the Tailwind config meant these all had to coexist without collision, while still allowing each app its own visual identity.","href":null}],"color":"default"}},{"object":"block","id":"532a3c49-14a9-4090-b6c5-f77f54e6ee6a","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"38 commits. Each one fixing some CSS gap I'd missed. But by the end I'd also extracted 4 new shared packages: PDF generation, chat history, shared chat UI, and common React hooks.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"38 commits. Each one fixing some CSS gap I'd missed. But by the end I'd also extracted 4 new shared packages: PDF generation, chat history, shared chat UI, and common React hooks.","href":null}],"color":"default"}},{"object":"block","id":"b55cacbd-60b6-4adb-828a-bc1c0821703a","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"The package extraction was the real win. Three apps each had their own ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The package extraction was the real win. Three apps each had their own ","href":null},{"type":"text","text":{"content":"ChatPanel","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ChatPanel","href":null},{"type":"text","text":{"content":" component with slightly different implementations. Three apps each had PDF export code with the same html2canvas workflow. Extracting these into ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" component with slightly different implementations. Three apps each had PDF export code with the same html2canvas workflow. Extracting these into ","href":null},{"type":"text","text":{"content":"packages/ui","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/ui","href":null},{"type":"text","text":{"content":" and ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" and ","href":null},{"type":"text","text":{"content":"packages/pdf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/pdf","href":null},{"type":"text","text":{"content":" meant a single fix would propagate everywhere.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" meant a single fix would propagate everywhere.","href":null}],"color":"default"}},{"object":"block","id":"22de8748-e3a6-4b58-aad9-a9394bb0f517","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Day 3: App #6 and WeChat Detection — 17 Commits","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Day 3: App #6 and WeChat Detection — 17 Commits","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"1e6da941-6f4f-4f85-8c81-e1eaca539d8f","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Added MBTI personality test as the sixth app. Easier to integrate because I built it knowing it would go into the monorepo — it used the shared packages from day one.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Added MBTI personality test as the sixth app. Easier to integrate because I built it knowing it would go into the monorepo — it used the shared packages from day one.","href":null}],"color":"default"}},{"object":"block","id":"dcb435b5-744b-47b7-91d6-4a8132151e5c","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"The more interesting challenge was WeChat browser detection. A massive percentage of Chinese internet traffic goes through WeChat's built-in browser, which has quirks: limited ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The more interesting challenge was WeChat browser detection. A massive percentage of Chinese internet traffic goes through WeChat's built-in browser, which has quirks: limited ","href":null},{"type":"text","text":{"content":"getUserMedia","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"getUserMedia","href":null},{"type":"text","text":{"content":" support, different OAuth flow requirements, restricted ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" support, different OAuth flow requirements, restricted ","href":null},{"type":"text","text":{"content":"window.open","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"window.open","href":null},{"type":"text","text":{"content":" behavior. The user agent sniffing needed to check for ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" behavior. The user agent sniffing needed to check for ","href":null},{"type":"text","text":{"content":"MicroMessenger","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"MicroMessenger","href":null},{"type":"text","text":{"content":" across Android, iOS, and desktop variants, plus the WeChat Work variant (","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" across Android, iOS, and desktop variants, plus the WeChat Work variant (","href":null},{"type":"text","text":{"content":"wxwork","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"wxwork","href":null},{"type":"text","text":{"content":").","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":").","href":null}],"color":"default"}},{"object":"block","id":"8c5001c9-5492-4462-89d5-31653d1159d6","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Later (PR #41), this detection got hardened further when real devices exposed false negatives — some WeChat versions embed a different UA string than documented.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Later (PR #41), this detection got hardened further when real devices exposed false negatives — some WeChat versions embed a different UA string than documented.","href":null}],"color":"default"}},{"object":"block","id":"2a44120a-d56b-4123-828c-cf37128416cf","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Day 4: The Big Day — 56 Commits","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Day 4: The Big Day — 56 Commits","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"21af4a1d-d8b3-43a7-9f39-cf8f47e827a8","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"The Unified API Package","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The Unified API Package","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"041dbb97-bbb7-4463-bc2a-108c12bc5cb3","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"The biggest architectural win of the entire project. ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The biggest architectural win of the entire project. ","href":null},{"type":"text","text":{"content":"packages/api","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/api","href":null},{"type":"text","text":{"content":" standardized how all apps talk to AI models.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" standardized how all apps talk to AI models.","href":null}],"color":"default"}},{"object":"block","id":"76f3de62-430e-453e-98f1-1106d781bf08","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Before: each app had its own streaming route with ~80 lines of boilerplate for ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Before: each app had its own streaming route with ~80 lines of boilerplate for ","href":null},{"type":"text","text":{"content":"ReadableStream","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ReadableStream","href":null},{"type":"text","text":{"content":" setup, SSE event formatting, error handling, and credit deduction. Duplicated 15+ times.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" setup, SSE event formatting, error handling, and credit deduction. Duplicated 15+ times.","href":null}],"color":"default"}},{"object":"block","id":"1b9431c8-cdd9-4ae8-a128-e0e15fc86aeb","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"After: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"After: ","href":null},{"type":"text","text":{"content":"createAIStreamResponse()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"createAIStreamResponse()","href":null},{"type":"text","text":{"content":" — a single helper that takes a config object with lifecycle hooks:","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — a single helper that takes a config object with lifecycle hooks:","href":null}],"color":"default"}},{"object":"block","id":"b0c36082-b8f9-4abf-ac2e-4dda0c026028","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"initEvents","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"initEvents","href":null},{"type":"text","text":{"content":" — emit initial data before AI streaming starts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — emit initial data before AI streaming starts","href":null}],"color":"default"}},{"object":"block","id":"cf01ad2b-b6b7-45e4-99c4-d32953ba36a3","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"onComplete","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"onComplete","href":null},{"type":"text","text":{"content":" — save results, log costs","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — save results, log costs","href":null}],"color":"default"}},{"object":"block","id":"728db129-e5ed-4a15-bd39-ae48ddc1ef09","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"onError","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"onError","href":null},{"type":"text","text":{"content":" — handle failures gracefully","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — handle failures gracefully","href":null}],"color":"default"}},{"object":"block","id":"73192fac-af48-49f8-9d98-e796d69c00f1","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"refundCreditsOnError","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"refundCreditsOnError","href":null},{"type":"text","text":{"content":" — automatically refund if the stream dies","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — automatically refund if the stream dies","href":null}],"color":"default"}},{"object":"block","id":"faf3bde9-d01b-4dae-9047-2d850b80aa6e","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"52 API routes migrated into this pattern. Claude Code did the migration by looking at one example and applying it to the rest. An hour of wall-clock time vs. what would have been a full day manually.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"52 API routes migrated into this pattern. Claude Code did the migration by looking at one example and applying it to the rest. An hour of wall-clock time vs. what would have been a full day manually.","href":null}],"color":"default"}},{"object":"block","id":"467b1ede-98fb-4e89-8e48-3dea57934ac1","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"The Content Filter v1","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The Content Filter v1","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"24061870-884d-4b5c-a617-44c00ebd8d2d","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Also built on Day 4: a DFA-based sensitive word filter. This is critical for the China market. Metaphysics content naturally includes terms that trigger naive keyword filters — 算命 (fortune-telling), 破财 (wealth loss), 桃花劫 (romantic disaster). A standard profanity filter would block half our legitimate content.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Also built on Day 4: a DFA-based sensitive word filter. This is critical for the China market. Metaphysics content naturally includes terms that trigger naive keyword filters — 算命 (fortune-telling), 破财 (wealth loss), 桃花劫 (romantic disaster). A standard profanity filter would block half our legitimate content.","href":null}],"color":"default"}},{"object":"block","id":"fd6f42a2-a19b-40dc-8bfe-053191e49345","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"The DFA (Deterministic Finite Automaton) approach builds a trie from the word list and streams through text character by character. This version blocked entire messages containing sensitive words — later iterations would get more sophisticated.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The DFA (Deterministic Finite Automaton) approach builds a trie from the word list and streams through text character by character. This version blocked entire messages containing sensitive words — later iterations would get more sophisticated.","href":null}],"color":"default"}},{"object":"block","id":"5027d112-40db-457b-afa4-8dddab2ba186","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"GDPR and Legal","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"GDPR and Legal","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0e08501a-a8e3-4acf-aeeb-c76177ba4fbf","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Knocked out bilingual terms of service and privacy policy. Not glamorous, but necessary. These would later be completely rewritten (PR #83) with separate Chinese and English versions and China AI regulatory compliance clauses.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Knocked out bilingual terms of service and privacy policy. Not glamorous, but necessary. These would later be completely rewritten (PR #83) with separate Chinese and English versions and China AI regulatory compliance clauses.","href":null}],"color":"default"}},{"object":"block","id":"67334072-bf1b-4099-ad50-3d17dc435988","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"The Moment","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The Moment","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ec18262d-f0df-4e61-97c7-103cf8ad653e","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Around 11 PM I started all 6 apps locally, logged in with one account, and watched credits sync across tabs. One login. One credit balance. Six products. It actually worked.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Around 11 PM I started all 6 apps locally, logged in with one account, and watched credits sync across tabs. One login. One credit balance. Six products. It actually worked.","href":null}],"color":"default"}},{"object":"block","id":"10c86ccf-17d2-4ec7-a962-246fdec30f68","parent":{"type":"page_id","page_id":"30be3dcd-5100-81e3-85bb-e4a7beac5052"},"created_time":"2026-02-19T04:54:00.000Z","last_edited_time":"2026-02-19T04:54:00.000Z","created_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"last_edited_by":{"object":"user","id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Three days ago I had 5 separate apps. Now I had one platform.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Three days ago I had 5 separate apps. Now I had one platform.","href":null}],"color":"default"}}]}}