{"block":{"30ce3dcd-5100-8120-9971-e551e4260cc9":{"type":"reader","value":{"id":"30ce3dcd-5100-8120-9971-e551e4260cc9","content":["30ce3dcd-5100-81c6-9206-f7f245261c53","30ce3dcd-5100-8112-90d1-f04df5e56552","30ce3dcd-5100-81a4-bd5d-dd19fe6db09b","30ce3dcd-5100-8139-8e99-c4777c481e31","30ce3dcd-5100-811f-8683-d20ce6a1e76d","30ce3dcd-5100-8198-b518-fef64bdca7af","30ce3dcd-5100-81fc-9ba1-f149af00a0d4","30ce3dcd-5100-818d-a701-e4c7e87d22c4","30ce3dcd-5100-819b-a34b-ee52ec214bee","30ce3dcd-5100-8163-a9eb-c260aa03c724","30ce3dcd-5100-81c8-a1da-ecbb0e044586","30ce3dcd-5100-819c-870d-fdf1c4baf254","30ce3dcd-5100-81cd-8c9b-cc64524f9576","30ce3dcd-5100-8101-84ad-d57eab98eede","30ce3dcd-5100-8195-ba8b-f38ac5f59c60","30ce3dcd-5100-819b-bc93-d6d68d159005","30ce3dcd-5100-817b-b096-ec8faa3061bd","30ce3dcd-5100-8124-8357-ca1623d72a62","30ce3dcd-5100-8124-9d20-c40e5669bcc2","30ce3dcd-5100-81b3-b7ec-cbf6dfe52d9a","30ce3dcd-5100-81bd-bf2f-d4b25a54a826","30ce3dcd-5100-815a-a805-f0239edab03b","30ce3dcd-5100-816f-959e-d2f060e3a2a1","30ce3dcd-5100-81fd-a927-ea86b34b3cac","30ce3dcd-5100-81d5-b504-c029771e45e2","30ce3dcd-5100-81d7-8fc4-f97d68287617","30ce3dcd-5100-81ed-b5ef-ed45d07b6b26","30ce3dcd-5100-8159-a457-db4964da0d5c"],"properties":{"title":[["第2-4天：Monorepo迁移冲刺（3天111次Commit）"]]},"format":{},"type":"page","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"dca90ad9-3257-474e-b521-628c56118169","parent_table":"table"}},"dca90ad9-3257-474e-b521-628c56118169":{"type":"reader","value":{"id":"dca90ad9-3257-474e-b521-628c56118169","properties":{},"format":{},"type":"child_database","created_time":1711415040000,"last_edited_time":1771510920000,"created_by_table":"notion_user","created_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","last_edited_by_table":"user","last_edited_by_id":"40113eb2-a511-4cb6-9c2c-cd555ea5681f","alive":true}},"30ce3dcd-5100-81c6-9206-f7f245261c53":{"type":"reader","value":{"id":"30ce3dcd-5100-81c6-9206-f7f245261c53","properties":{"title":[["三天。111次commit。我敢说其中一半的commit message都写着\"fix css\"。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8112-90d1-f04df5e56552":{"type":"reader","value":{"id":"30ce3dcd-5100-8112-90d1-f04df5e56552","properties":{"title":[["第2天：CSS修复地狱 — 38次Commit"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81a4-bd5d-dd19fe6db09b":{"type":"reader","value":{"id":"30ce3dcd-5100-81a4-bd5d-dd19fe6db09b","properties":{"title":[["当我把Tailwind配置统一到"],["packages/config",[["c"]]],["之后，每一个依赖自定义design token的应用都崩了。不是那种明显的\"红色报错页面\"式崩溃，而是那种微妙的\"背景颜色好像不太对，为什么那个按钮小了2px\"式崩溃。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8139-8e99-c4777c481e31":{"type":"reader","value":{"id":"30ce3dcd-5100-8139-8e99-c4777c481e31","properties":{"title":[["问题在于：每个应用进化出了自己的CSS变量命名空间。八字用"],["--bz-*",[["c"]]],["系列token，塔罗用"],["--tarot-*",[["c"]]],["，占星用"],["--zx-*",[["c"]]],["。统一Tailwind配置意味着这些都得共存且不能冲突，同时每个应用还要保持自己的视觉风格。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-811f-8683-d20ce6a1e76d":{"type":"reader","value":{"id":"30ce3dcd-5100-811f-8683-d20ce6a1e76d","properties":{"title":[["38次commit。每一次都在修我之前漏掉的CSS问题。但到最后，我也同时提取了4个新的共享包：PDF生成、聊天记录、共享聊天UI、以及通用React hooks。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8198-b518-fef64bdca7af":{"type":"reader","value":{"id":"30ce3dcd-5100-8198-b518-fef64bdca7af","properties":{"title":[["包的提取才是真正的收获。三个应用各自有自己的"],["ChatPanel",[["c"]]],["组件，实现略有不同。三个应用各自有PDF导出代码，用的都是同样的html2canvas流程。把这些提取到"],["packages/ui",[["c"]]],["和"],["packages/pdf",[["c"]]],["，意味着一处修复，处处生效。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81fc-9ba1-f149af00a0d4":{"type":"reader","value":{"id":"30ce3dcd-5100-81fc-9ba1-f149af00a0d4","properties":{"title":[["第3天：第6个应用和微信检测 — 17次Commit"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-818d-a701-e4c7e87d22c4":{"type":"reader","value":{"id":"30ce3dcd-5100-818d-a701-e4c7e87d22c4","properties":{"title":[["新增了MBTI人格测试作为第六个应用。集成起来更轻松，因为一开始就知道它要进monorepo——从第一天就用上了共享包。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-819b-a34b-ee52ec214bee":{"type":"reader","value":{"id":"30ce3dcd-5100-819b-a34b-ee52ec214bee","properties":{"title":[["更有意思的挑战是微信浏览器检测。中国互联网流量中有相当大的比例是通过微信内置浏览器产生的，而这个浏览器有各种坑：有限的"],["getUserMedia",[["c"]]],["支持、不同的OAuth流程要求、受限的"],["window.open",[["c"]]],["行为。UA嗅探需要检查Android、iOS和桌面端各版本中的"],["MicroMessenger",[["c"]]],["，还有企业微信变体（"],["wxwork",[["c"]]],["）。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8163-a9eb-c260aa03c724":{"type":"reader","value":{"id":"30ce3dcd-5100-8163-a9eb-c260aa03c724","properties":{"title":[["后来（PR #41），当真实设备暴露了漏检问题时，这个检测又做了一次加固——某些微信版本嵌入的UA字符串和文档记载的不一样。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81c8-a1da-ecbb0e044586":{"type":"reader","value":{"id":"30ce3dcd-5100-81c8-a1da-ecbb0e044586","properties":{"title":[["第4天：大日子 — 56次Commit"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-819c-870d-fdf1c4baf254":{"type":"reader","value":{"id":"30ce3dcd-5100-819c-870d-fdf1c4baf254","properties":{"title":[["统一API包"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81cd-8c9b-cc64524f9576":{"type":"reader","value":{"id":"30ce3dcd-5100-81cd-8c9b-cc64524f9576","properties":{"title":[["整个项目最大的架构胜利。"],["packages/api",[["c"]]],["标准化了所有应用与AI模型通信的方式。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8101-84ad-d57eab98eede":{"type":"reader","value":{"id":"30ce3dcd-5100-8101-84ad-d57eab98eede","properties":{"title":[["之前：每个应用都有自己的流式路由，大约80行样板代码用于"],["ReadableStream",[["c"]]],["设置、SSE事件格式化、错误处理和积分扣减。重复了15次以上。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8195-ba8b-f38ac5f59c60":{"type":"reader","value":{"id":"30ce3dcd-5100-8195-ba8b-f38ac5f59c60","properties":{"title":[["之后："],["createAIStreamResponse()",[["c"]]],[" — 一个工具函数，接收一个带有生命周期钩子的配置对象："]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-819b-bc93-d6d68d159005":{"type":"reader","value":{"id":"30ce3dcd-5100-819b-bc93-d6d68d159005","properties":{"title":[["initEvents",[["c"]]],[" — 在AI流式传输开始前发送初始数据"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-817b-b096-ec8faa3061bd":{"type":"reader","value":{"id":"30ce3dcd-5100-817b-b096-ec8faa3061bd","properties":{"title":[["onComplete",[["c"]]],[" — 保存结果、记录费用"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8124-8357-ca1623d72a62":{"type":"reader","value":{"id":"30ce3dcd-5100-8124-8357-ca1623d72a62","properties":{"title":[["onError",[["c"]]],[" — 优雅地处理失败"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8124-9d20-c40e5669bcc2":{"type":"reader","value":{"id":"30ce3dcd-5100-8124-9d20-c40e5669bcc2","properties":{"title":[["refundCreditsOnError",[["c"]]],[" — 流中断时自动退还积分"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81b3-b7ec-cbf6dfe52d9a":{"type":"reader","value":{"id":"30ce3dcd-5100-81b3-b7ec-cbf6dfe52d9a","properties":{"title":[["52条API路由迁移到了这个模式。Claude Code通过看一个示例就能把它应用到其余所有路由。实际耗时大约一小时，手动做的话至少要整整一天。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81bd-bf2f-d4b25a54a826":{"type":"reader","value":{"id":"30ce3dcd-5100-81bd-bf2f-d4b25a54a826","properties":{"title":[["内容过滤器v1"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-815a-a805-f0239edab03b":{"type":"reader","value":{"id":"30ce3dcd-5100-815a-a805-f0239edab03b","properties":{"title":[["同样在第4天完成：基于DFA的敏感词过滤器。这对中国市场至关重要。玄学内容天然包含一些会触发简单关键词过滤的词——算命、破财、桃花劫。一个标准的敏感词过滤器会把我们一半的正常内容都屏蔽掉。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-816f-959e-d2f060e3a2a1":{"type":"reader","value":{"id":"30ce3dcd-5100-816f-959e-d2f060e3a2a1","properties":{"title":[["DFA（确定性有限自动机）的方法是从词表构建一棵trie树，然后逐字符扫描文本。这个版本会直接屏蔽包含敏感词的整条消息——后续迭代会变得更加精细。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81fd-a927-ea86b34b3cac":{"type":"reader","value":{"id":"30ce3dcd-5100-81fd-a927-ea86b34b3cac","properties":{"title":[["GDPR和法律合规"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81d5-b504-c029771e45e2":{"type":"reader","value":{"id":"30ce3dcd-5100-81d5-b504-c029771e45e2","properties":{"title":[["搞定了中英双语的服务条款和隐私政策。不光鲜，但必须做。后来（PR #83）又进行了全面重写，分成了独立的中文版和英文版，并加入了中国AI监管合规条款。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81d7-8fc4-f97d68287617":{"type":"reader","value":{"id":"30ce3dcd-5100-81d7-8fc4-f97d68287617","properties":{"title":[["那个瞬间"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-81ed-b5ef-ed45d07b6b26":{"type":"reader","value":{"id":"30ce3dcd-5100-81ed-b5ef-ed45d07b6b26","properties":{"title":[["大约晚上11点，我在本地同时启动了6个应用，用同一个账号登录，看着积分在各个标签页之间实时同步。一次登录。一个积分余额。六个产品。它真的跑起来了。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}},"30ce3dcd-5100-8159-a457-db4964da0d5c":{"type":"reader","value":{"id":"30ce3dcd-5100-8159-a457-db4964da0d5c","properties":{"title":[["三天前我还有5个独立应用。现在我有了一个平台。"]]},"format":{"block_color":"default"},"type":"text","created_time":1771518120000,"last_edited_time":1771518120000,"created_by_table":"notion_user","created_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","last_edited_by_table":"user","last_edited_by_id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1","alive":true,"parent_id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent_table":"block"}}},"collection":{},"collection_view":{},"collection_query":{},"signed_urls":{},"notion_user":{},"raw":{"page":{"object":"page","id":"30ce3dcd-5100-8120-9971-e551e4260cc9","created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"dca90ad9-3257-474e-b521-628c56118169"},"archived":false,"in_trash":false,"is_locked":false,"properties":{"Series":{"id":"%3EteD","type":"select","select":{"id":"d6cedf54-9cfc-4d7b-a947-45d43dac1c0e","name":"盘盘猫开发日记","color":"yellow"}},"Part":{"id":"%3FGyQ","type":"number","number":2},"date":{"id":"NX%5CQ","type":"date","date":{"start":"2026-01-24","end":null,"time_zone":null}},"type":{"id":"%60gQ~","type":"select","select":{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","name":"Post","color":"purple"}},"slug":{"id":"d%5Dhq","type":"rich_text","rich_text":[{"type":"text","text":{"content":"panpanmao-diary-02-migration-sprint-zh","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"panpanmao-diary-02-migration-sprint-zh","href":null}]},"tags":{"id":"sD%5Em","type":"multi_select","multi_select":[{"id":"14e583db-d1a1-416a-92c8-61b25c8a9500","name":"AI","color":"orange"},{"id":"94107512-fb67-4f90-9644-26758c03fc71","name":"Software Development","color":"purple"}]},"URL":{"id":"w%3AG%3A","type":"url","url":null},"summary":{"id":"wz%7CS","type":"rich_text","rich_text":[{"type":"text","text":{"content":"盘盘猫开发日记第2-4天：CSS修复地狱、共享包提取、新增MBTI应用、微信浏览器检测，以及统一API层完成52条路由迁移。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"盘盘猫开发日记第2-4天：CSS修复地狱、共享包提取、新增MBTI应用、微信浏览器检测，以及统一API层完成52条路由迁移。","href":null}]},"title":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"第2-4天：Monorepo迁移冲刺（3天111次Commit）","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"第2-4天：Monorepo迁移冲刺（3天111次Commit）","href":null}]},"status":{"id":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee","type":"select","select":{"id":"7abc61d4-b405-480d-b699-12588755fa65","name":"Published","color":"red"}}},"url":"https://www.notion.so/2-4-Monorepo-3-111-Commit-30ce3dcd510081209971e551e4260cc9","public_url":"https://xingfanxia.notion.site/2-4-Monorepo-3-111-Commit-30ce3dcd510081209971e551e4260cc9","request_id":"72e7a563-7ff6-4197-8403-a86d8d4fb38a"},"block":{"object":"block","id":"30ce3dcd-5100-8120-9971-e551e4260cc9","parent":{"type":"database_id","database_id":"dca90ad9-3257-474e-b521-628c56118169"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":true,"archived":false,"in_trash":false,"type":"child_page","child_page":{"title":"第2-4天：Monorepo迁移冲刺（3天111次Commit）"},"request_id":"5c619b91-393c-4cdf-8e9a-2f92ab218521"},"children":[{"object":"block","id":"30ce3dcd-5100-81c6-9206-f7f245261c53","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"三天。111次commit。我敢说其中一半的commit message都写着\"fix css\"。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"三天。111次commit。我敢说其中一半的commit message都写着\"fix css\"。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8112-90d1-f04df5e56552","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"第2天：CSS修复地狱 — 38次Commit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"第2天：CSS修复地狱 — 38次Commit","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81a4-bd5d-dd19fe6db09b","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"当我把Tailwind配置统一到","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"当我把Tailwind配置统一到","href":null},{"type":"text","text":{"content":"packages/config","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/config","href":null},{"type":"text","text":{"content":"之后，每一个依赖自定义design token的应用都崩了。不是那种明显的\"红色报错页面\"式崩溃，而是那种微妙的\"背景颜色好像不太对，为什么那个按钮小了2px\"式崩溃。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"之后，每一个依赖自定义design token的应用都崩了。不是那种明显的\"红色报错页面\"式崩溃，而是那种微妙的\"背景颜色好像不太对，为什么那个按钮小了2px\"式崩溃。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8139-8e99-c4777c481e31","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"问题在于：每个应用进化出了自己的CSS变量命名空间。八字用","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"问题在于：每个应用进化出了自己的CSS变量命名空间。八字用","href":null},{"type":"text","text":{"content":"--bz-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--bz-*","href":null},{"type":"text","text":{"content":"系列token，塔罗用","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"系列token，塔罗用","href":null},{"type":"text","text":{"content":"--tarot-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--tarot-*","href":null},{"type":"text","text":{"content":"，占星用","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"，占星用","href":null},{"type":"text","text":{"content":"--zx-*","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"--zx-*","href":null},{"type":"text","text":{"content":"。统一Tailwind配置意味着这些都得共存且不能冲突，同时每个应用还要保持自己的视觉风格。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"。统一Tailwind配置意味着这些都得共存且不能冲突，同时每个应用还要保持自己的视觉风格。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-811f-8683-d20ce6a1e76d","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"38次commit。每一次都在修我之前漏掉的CSS问题。但到最后，我也同时提取了4个新的共享包：PDF生成、聊天记录、共享聊天UI、以及通用React hooks。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"38次commit。每一次都在修我之前漏掉的CSS问题。但到最后，我也同时提取了4个新的共享包：PDF生成、聊天记录、共享聊天UI、以及通用React hooks。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8198-b518-fef64bdca7af","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"包的提取才是真正的收获。三个应用各自有自己的","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"包的提取才是真正的收获。三个应用各自有自己的","href":null},{"type":"text","text":{"content":"ChatPanel","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ChatPanel","href":null},{"type":"text","text":{"content":"组件，实现略有不同。三个应用各自有PDF导出代码，用的都是同样的html2canvas流程。把这些提取到","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"组件，实现略有不同。三个应用各自有PDF导出代码，用的都是同样的html2canvas流程。把这些提取到","href":null},{"type":"text","text":{"content":"packages/ui","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/ui","href":null},{"type":"text","text":{"content":"和","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"和","href":null},{"type":"text","text":{"content":"packages/pdf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/pdf","href":null},{"type":"text","text":{"content":"，意味着一处修复，处处生效。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"，意味着一处修复，处处生效。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81fc-9ba1-f149af00a0d4","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"第3天：第6个应用和微信检测 — 17次Commit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"第3天：第6个应用和微信检测 — 17次Commit","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-818d-a701-e4c7e87d22c4","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"新增了MBTI人格测试作为第六个应用。集成起来更轻松，因为一开始就知道它要进monorepo——从第一天就用上了共享包。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"新增了MBTI人格测试作为第六个应用。集成起来更轻松，因为一开始就知道它要进monorepo——从第一天就用上了共享包。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-819b-a34b-ee52ec214bee","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"更有意思的挑战是微信浏览器检测。中国互联网流量中有相当大的比例是通过微信内置浏览器产生的，而这个浏览器有各种坑：有限的","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"更有意思的挑战是微信浏览器检测。中国互联网流量中有相当大的比例是通过微信内置浏览器产生的，而这个浏览器有各种坑：有限的","href":null},{"type":"text","text":{"content":"getUserMedia","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"getUserMedia","href":null},{"type":"text","text":{"content":"支持、不同的OAuth流程要求、受限的","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"支持、不同的OAuth流程要求、受限的","href":null},{"type":"text","text":{"content":"window.open","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"window.open","href":null},{"type":"text","text":{"content":"行为。UA嗅探需要检查Android、iOS和桌面端各版本中的","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"行为。UA嗅探需要检查Android、iOS和桌面端各版本中的","href":null},{"type":"text","text":{"content":"MicroMessenger","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"MicroMessenger","href":null},{"type":"text","text":{"content":"，还有企业微信变体（","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"，还有企业微信变体（","href":null},{"type":"text","text":{"content":"wxwork","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"wxwork","href":null},{"type":"text","text":{"content":"）。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"）。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8163-a9eb-c260aa03c724","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"后来（PR #41），当真实设备暴露了漏检问题时，这个检测又做了一次加固——某些微信版本嵌入的UA字符串和文档记载的不一样。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"后来（PR #41），当真实设备暴露了漏检问题时，这个检测又做了一次加固——某些微信版本嵌入的UA字符串和文档记载的不一样。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81c8-a1da-ecbb0e044586","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"第4天：大日子 — 56次Commit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"第4天：大日子 — 56次Commit","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-819c-870d-fdf1c4baf254","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"统一API包","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"统一API包","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81cd-8c9b-cc64524f9576","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"整个项目最大的架构胜利。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"整个项目最大的架构胜利。","href":null},{"type":"text","text":{"content":"packages/api","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"packages/api","href":null},{"type":"text","text":{"content":"标准化了所有应用与AI模型通信的方式。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"标准化了所有应用与AI模型通信的方式。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8101-84ad-d57eab98eede","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"之前：每个应用都有自己的流式路由，大约80行样板代码用于","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"之前：每个应用都有自己的流式路由，大约80行样板代码用于","href":null},{"type":"text","text":{"content":"ReadableStream","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ReadableStream","href":null},{"type":"text","text":{"content":"设置、SSE事件格式化、错误处理和积分扣减。重复了15次以上。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"设置、SSE事件格式化、错误处理和积分扣减。重复了15次以上。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8195-ba8b-f38ac5f59c60","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"之后：","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"之后：","href":null},{"type":"text","text":{"content":"createAIStreamResponse()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"createAIStreamResponse()","href":null},{"type":"text","text":{"content":" — 一个工具函数，接收一个带有生命周期钩子的配置对象：","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — 一个工具函数，接收一个带有生命周期钩子的配置对象：","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-819b-bc93-d6d68d159005","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"initEvents","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"initEvents","href":null},{"type":"text","text":{"content":" — 在AI流式传输开始前发送初始数据","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — 在AI流式传输开始前发送初始数据","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-817b-b096-ec8faa3061bd","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"onComplete","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"onComplete","href":null},{"type":"text","text":{"content":" — 保存结果、记录费用","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — 保存结果、记录费用","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8124-8357-ca1623d72a62","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"onError","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"onError","href":null},{"type":"text","text":{"content":" — 优雅地处理失败","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — 优雅地处理失败","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8124-9d20-c40e5669bcc2","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"refundCreditsOnError","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"refundCreditsOnError","href":null},{"type":"text","text":{"content":" — 流中断时自动退还积分","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" — 流中断时自动退还积分","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81b3-b7ec-cbf6dfe52d9a","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"52条API路由迁移到了这个模式。Claude Code通过看一个示例就能把它应用到其余所有路由。实际耗时大约一小时，手动做的话至少要整整一天。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"52条API路由迁移到了这个模式。Claude Code通过看一个示例就能把它应用到其余所有路由。实际耗时大约一小时，手动做的话至少要整整一天。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81bd-bf2f-d4b25a54a826","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"内容过滤器v1","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"内容过滤器v1","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-815a-a805-f0239edab03b","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"同样在第4天完成：基于DFA的敏感词过滤器。这对中国市场至关重要。玄学内容天然包含一些会触发简单关键词过滤的词——算命、破财、桃花劫。一个标准的敏感词过滤器会把我们一半的正常内容都屏蔽掉。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"同样在第4天完成：基于DFA的敏感词过滤器。这对中国市场至关重要。玄学内容天然包含一些会触发简单关键词过滤的词——算命、破财、桃花劫。一个标准的敏感词过滤器会把我们一半的正常内容都屏蔽掉。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-816f-959e-d2f060e3a2a1","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"DFA（确定性有限自动机）的方法是从词表构建一棵trie树，然后逐字符扫描文本。这个版本会直接屏蔽包含敏感词的整条消息——后续迭代会变得更加精细。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"DFA（确定性有限自动机）的方法是从词表构建一棵trie树，然后逐字符扫描文本。这个版本会直接屏蔽包含敏感词的整条消息——后续迭代会变得更加精细。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81fd-a927-ea86b34b3cac","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"GDPR和法律合规","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"GDPR和法律合规","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81d5-b504-c029771e45e2","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"搞定了中英双语的服务条款和隐私政策。不光鲜，但必须做。后来（PR #83）又进行了全面重写，分成了独立的中文版和英文版，并加入了中国AI监管合规条款。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"搞定了中英双语的服务条款和隐私政策。不光鲜，但必须做。后来（PR #83）又进行了全面重写，分成了独立的中文版和英文版，并加入了中国AI监管合规条款。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81d7-8fc4-f97d68287617","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"那个瞬间","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"那个瞬间","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"30ce3dcd-5100-81ed-b5ef-ed45d07b6b26","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"大约晚上11点，我在本地同时启动了6个应用，用同一个账号登录，看着积分在各个标签页之间实时同步。一次登录。一个积分余额。六个产品。它真的跑起来了。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"大约晚上11点，我在本地同时启动了6个应用，用同一个账号登录，看着积分在各个标签页之间实时同步。一次登录。一个积分余额。六个产品。它真的跑起来了。","href":null}],"color":"default"}},{"object":"block","id":"30ce3dcd-5100-8159-a457-db4964da0d5c","parent":{"type":"page_id","page_id":"30ce3dcd-5100-8120-9971-e551e4260cc9"},"created_time":"2026-02-19T16:22:00.000Z","last_edited_time":"2026-02-19T16:22:00.000Z","created_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"last_edited_by":{"object":"user","id":"7f97ee67-86aa-4254-a07b-42fd6c3d15a1"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"三天前我还有5个独立应用。现在我有了一个平台。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"三天前我还有5个独立应用。现在我有了一个平台。","href":null}],"color":"default"}}]}}